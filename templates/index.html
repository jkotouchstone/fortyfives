<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Forty-Fives Card Game</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #006400; /* Green felt table */
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #fff;
      overflow: hidden;
    }
    #table {
      position: relative;
      width: 100%;
      height: 100vh;
      display: grid;
      grid-template-areas:
        "score score score"
        "comp comp comp"
        "left center right"
        "player player player";
      grid-template-rows: auto 150px 1fr 200px;
      grid-template-columns: 1fr 2fr 1fr;
      padding: 20px;
      box-sizing: border-box;
    }
    /* Scoreboard */
    #scoreboard {
      grid-area: score;
      background: rgba(0, 0, 0, 0.7);
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 1.1em;
    }
    /* Computer's hand */
    #compArea {
      grid-area: comp;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    /* Center area */
    #centerArea {
      grid-area: center;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      border: 3px dashed rgba(255,255,255,0.7);
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.5);
    }
    /* Player's hand */
    #playerArea {
      grid-area: player;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    /* Card styling */
    .card {
      width: 80px;
      cursor: pointer;
      border-radius: 5px;
      transition: transform 0.2s;
    }
    .card:hover {
      transform: scale(1.1);
    }
  </style>
</head>
<body>
<div id="table">
  <div id="scoreboard">
    <div id="scoreInfo">Scores Loading...</div>
  </div>
  <div id="compArea">
    <!-- Computer's hand (card backs) -->
    <div id="compHand"></div>
  </div>
  <div id="centerArea">
    <!-- Center area (for trick play) -->
    <span id="trickPrompt">No trick yet</span>
  </div>
  <div id="playerArea">
    <!-- Player's hand -->
    <div id="playerHand"></div>
  </div>
</div>

<script>
  function log(msg) {
    const logDiv = document.getElementById("scoreboard");
    logDiv.innerHTML += `<p>${msg}</p>`;
  }

  function showState() {
    fetch('/show_state')
      .then(res => res.json())
      .then(data => {
        console.log(data);

        // Update player's hand
        const playerHand = document.getElementById("playerHand");
        playerHand.innerHTML = "";
        data.your_cards.forEach(card => {
          const img = document.createElement("img");
          img.src = card.img;
          img.className = "card";
          img.alt = card.name;
          img.onclick = () => console.log(`You selected ${card.name}`);
          playerHand.appendChild(img);
        });

        // Update computer's hand (card backs)
        const compHand = document.getElementById("compHand");
        compHand.innerHTML = "";
        for (let i = 0; i < data.computer_count; i++) {
          const img = document.createElement("img");
          img.src = data.card_back;
          img.className = "card";
          compHand.appendChild(img);
        }

        // Update scores
        document.getElementById("scoreInfo").textContent =
          `You: ${data.total_your} | Computer: ${data.total_comp}`;

        // Update trick prompt
        const trickPrompt = document.getElementById("trickPrompt");
        trickPrompt.textContent = data.trick_play_active ? "Play your card" : "Waiting for next trick";
      })
      .catch(err => console.error("Error fetching game state:", err));
  }

  window.onload = showState;
</script>
</body>
</html>
